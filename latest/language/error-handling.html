<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Error Handling - Rust for Java Developers</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../ferris.css">

    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../introduction.html">Introduction</a></li><li class="chapter-item expanded affix "><a href="../license.html">License</a></li><li class="chapter-item expanded affix "><a href="../contributing.html">Contributing</a></li><li class="chapter-item expanded "><a href="../getting-started/index.html"><strong aria-hidden="true">1.</strong> Getting Started</a></li><li class="chapter-item expanded "><a href="../hello-world/index.html"><strong aria-hidden="true">2.</strong> Hello World</a></li><li class="chapter-item expanded "><a href="../language/index.html"><strong aria-hidden="true">3.</strong> Language Features</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../language/data-types.html"><strong aria-hidden="true">3.1.</strong> Data Types</a></li><li class="chapter-item expanded "><a href="../language/variables-and-constants.html"><strong aria-hidden="true">3.2.</strong> Variables and Constants</a></li><li class="chapter-item expanded "><a href="../language/strings.html"><strong aria-hidden="true">3.3.</strong> Strings</a></li><li class="chapter-item expanded "><a href="../language/collection-types.html"><strong aria-hidden="true">3.4.</strong> Collection Types</a></li><li class="chapter-item expanded "><a href="../language/functions.html"><strong aria-hidden="true">3.5.</strong> Functions</a></li><li class="chapter-item expanded "><a href="../language/control-flow.html"><strong aria-hidden="true">3.6.</strong> Control Flow</a></li><li class="chapter-item expanded "><a href="../language/custom-types/index.html"><strong aria-hidden="true">3.7.</strong> Custom Types</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../language/custom-types/classes.html"><strong aria-hidden="true">3.7.1.</strong> Classes</a></li><li class="chapter-item expanded "><a href="../language/custom-types/records.html"><strong aria-hidden="true">3.7.2.</strong> Records</a></li><li class="chapter-item expanded "><a href="../language/custom-types/structs.html"><strong aria-hidden="true">3.7.3.</strong> Structures</a></li><li class="chapter-item expanded "><a href="../language/custom-types/interfaces-and-traits.html"><strong aria-hidden="true">3.7.4.</strong> Interfaces and Traits</a></li><li class="chapter-item expanded "><a href="../language/custom-types/enums.html"><strong aria-hidden="true">3.7.5.</strong> Enumerated Types</a></li><li class="chapter-item expanded "><a href="../language/custom-types/members.html"><strong aria-hidden="true">3.7.6.</strong> Members</a></li></ol></li><li class="chapter-item expanded "><a href="../language/lambdas-and-closures.html"><strong aria-hidden="true">3.8.</strong> Lambdas and Closures</a></li><li class="chapter-item expanded "><a href="../language/streams-and-iterators.html"><strong aria-hidden="true">3.9.</strong> Streams and Iterators</a></li><li class="chapter-item expanded "><a href="../language/pattern-matching.html"><strong aria-hidden="true">3.10.</strong> Pattern Matching</a></li><li class="chapter-item expanded "><a href="../language/packages-and-modules.html"><strong aria-hidden="true">3.11.</strong> Packages and Modules</a></li><li class="chapter-item expanded "><a href="../language/equality.html"><strong aria-hidden="true">3.12.</strong> Equality</a></li><li class="chapter-item expanded "><a href="../language/generics.html"><strong aria-hidden="true">3.13.</strong> Generics</a></li><li class="chapter-item expanded "><a href="../language/polymorphism.html"><strong aria-hidden="true">3.14.</strong> Polymorphism</a></li><li class="chapter-item expanded "><a href="../language/inheritance.html"><strong aria-hidden="true">3.15.</strong> Inheritance</a></li><li class="chapter-item expanded "><a href="../language/error-handling.html" class="active"><strong aria-hidden="true">3.16.</strong> Error Handling</a></li><li class="chapter-item expanded "><a href="../language/nullability-and-optionality.html"><strong aria-hidden="true">3.17.</strong> Nullability and Optionality</a></li><li class="chapter-item expanded "><a href="../language/conversion-and-casting.html"><strong aria-hidden="true">3.18.</strong> Conversion and Casting</a></li><li class="chapter-item expanded "><a href="../language/annotations.html"><strong aria-hidden="true">3.19.</strong> Annotations</a></li><li class="chapter-item expanded "><a href="../language/smart-pointers.html"><strong aria-hidden="true">3.20.</strong> Smart Pointers</a></li><li class="chapter-item expanded "><a href="../language/documentation-comments.html"><strong aria-hidden="true">3.21.</strong> Documentation Comments</a></li></ol></li><li class="chapter-item expanded "><a href="../memory-management/index.html"><strong aria-hidden="true">4.</strong> Memory Management</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../memory-management/ownership.html"><strong aria-hidden="true">4.1.</strong> Ownership</a></li><li class="chapter-item expanded "><a href="../memory-management/references-and-lifetimes.html"><strong aria-hidden="true">4.2.</strong> References and Lifetimes</a></li></ol></li><li class="chapter-item expanded "><a href="../resource-management/index.html"><strong aria-hidden="true">5.</strong> Resource Management</a></li><li class="chapter-item expanded "><a href="../threading-and-concurrency/index.html"><strong aria-hidden="true">6.</strong> Threading and Concurrency</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../threading-and-concurrency/threads.html"><strong aria-hidden="true">6.1.</strong> Threads</a></li><li class="chapter-item expanded "><a href="../threading-and-concurrency/synchronization.html"><strong aria-hidden="true">6.2.</strong> Synchronization</a></li><li class="chapter-item expanded "><a href="../threading-and-concurrency/producer-consumer.html"><strong aria-hidden="true">6.3.</strong> Producer-Consumer Pattern</a></li></ol></li><li class="chapter-item expanded "><a href="../testing/index.html"><strong aria-hidden="true">7.</strong> Testing</a></li><li class="chapter-item expanded "><a href="../benchmarking/index.html"><strong aria-hidden="true">8.</strong> Benchmarking</a></li><li class="chapter-item expanded "><a href="../logging-and-tracing/index.html"><strong aria-hidden="true">9.</strong> Logging and Tracing</a></li><li class="chapter-item expanded "><a href="../environment-and-configuration/index.html"><strong aria-hidden="true">10.</strong> Environment and Configuration</a></li><li class="chapter-item expanded "><a href="../build-tools/index.html"><strong aria-hidden="true">11.</strong> Build Tools</a></li><li class="chapter-item expanded "><a href="../project-structure/index.html"><strong aria-hidden="true">12.</strong> Project Structure</a></li><li class="chapter-item expanded "><a href="../meta-programming/index.html"><strong aria-hidden="true">13.</strong> Meta Programming</a></li><li class="chapter-item expanded "><a href="../asynchronous-programming/index.html"><strong aria-hidden="true">14.</strong> Asynchronous Programming</a></li><li class="chapter-item expanded affix "><a href="../next-steps.html">Next Steps</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Rust for Java Developers</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/chrischiedo/rust-for-java-devs" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/chrischiedo/rust-for-java-devs/edit/main/src/language/error-handling.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="error-handling"><a class="header" href="#error-handling">Error Handling</a></h1>
<p>In Java, an <em>exception</em> is a type that inherits from the <a href="https://docs.oracle.com/en/java/javase/21/docs/api/java.base/java/lang/Throwable.html"><code>Throwable</code></a> class. This class is the superclass of all errors and exceptions in the Java language. Exceptions are thrown if a problem occurs in a code section. A thrown exception is passed up the stack until the application handles it or the program terminates.</p>
<p>Java distinguishes between <em>checked</em> and <em>unchecked</em> exceptions. The <code>Throwable</code> class has two immmediate descendant classes: <code>Error</code> and <code>Exception</code>. Subclasses of the <code>Error</code> class are fatal errors and are called <em>unchecked</em> exceptions, and are not required to be caught. Subclasses of the <code>Exception</code> class (excluding <code>RuntimeException</code>) are called 
<em>checked</em> exceptions and have to be handled in your code.</p>
<p>Rust does not have exceptions, but distinguishes between <em>recoverable</em> and 
<em>unrecoverable</em> errors instead. A recoverable error represents a problem that
should be reported, but for which the program continues. Results of operations
that can fail with recoverable errors are of type <a href="https://doc.rust-lang.org/std/result/enum.Result.html"><code>Result&lt;T, E&gt;</code></a>,
where <code>E</code> is the type of the error variant. The <a href="https://doc.rust-lang.org/std/macro.panic.html"><code>panic!</code></a> macro stops
execution when the program encounters an unrecoverable error. An unrecoverable
error is always a symptom of a bug.</p>
<h2 id="custom-error-types"><a class="header" href="#custom-error-types">Custom error types</a></h2>
<p>In Java, you can create your own custom exceptions by extending the <code>Exception</code> class (or one of the classes from the <code>Throwable</code> hierarchy). Here's a simple example:</p>
<pre><code class="language-java">public class EmployeeListNotFoundException extends Exception {

    public EmployeeListNotFoundException() { }

    public EmployeeListNotFoundException(String message) {
        super(message);
    }

    public EmployeeListNotFoundException(String message, Throwable cause) {
        super(message, cause);
    }
}
</code></pre>
<p>In Rust, one can implement the basic expectations for error values by
implementing the <a href="https://doc.rust-lang.org/std/error/trait.Error.html"><code>Error</code></a> trait. The minimal user-defined error
implementation in Rust is:</p>
<pre><code class="language-rust">#[derive(Debug)]
pub struct EmployeeListNotFound;

impl std::fmt::Display for EmployeeListNotFound {
    fn fmt(&amp;self, f: &amp;mut std::fmt::Formatter&lt;'_&gt;) -&gt; std::fmt::Result {
        f.write_str(&quot;Could not find employee list.&quot;)
    }
}

impl std::error::Error for EmployeeListNotFound {}</code></pre>
<p>The equivalent to Java's <code>Throwable.getCause()</code> method is the <code>Error::source()</code> method in Rust. However, it is not required to provide an implementation for <code>Error::source()</code>, the blanket (default) implementation returns a <code>None</code>.</p>
<h2 id="raising-exceptions"><a class="header" href="#raising-exceptions">Raising exceptions</a></h2>
<p>To raise an exception in Java, throw an instance of the <code>Exception</code> class or any of the subclasses in its hierarchy:</p>
<pre><code class="language-java">static void throwIfNegative(int value) {
    if (value &lt; 0) {
        throw new IllegalArgumentException(&quot;Illegal argument value&quot;);
    }
}
</code></pre>
<p>For recoverable errors in Rust, return an <code>Ok</code> or <code>Err</code> variant from a method:</p>
<pre><code class="language-rust">fn error_if_negative(value: i32) -&gt; Result&lt;(), &amp;'static str&gt; {
    if value &lt; 0 {
        Err(&quot;Illegal argument value. (Parameter 'value')&quot;)
    } else {
        Ok(())
    }
}</code></pre>
<p>The <a href="https://doc.rust-lang.org/std/macro.panic.html"><code>panic!</code></a> macro creates unrecoverable errors:</p>
<pre><code class="language-rust">fn panic_if_negative(value: i32) {
    if value &lt; 0 {
        panic!(&quot;Illegal argument value. (Parameter 'value')&quot;)
    }
}</code></pre>
<h2 id="error-propagation"><a class="header" href="#error-propagation">Error propagation</a></h2>
<p>In Java, exceptions are passed up the stack until they are handled or the
program terminates.</p>
<p>In Rust, unrecoverable errors behave similarly, but handling
them is uncommon. Recoverable errors, however, need to be propagated and handled explicitly. Their presence is always indicated by the Rust function or method signature.</p>
<p>Catching an exception allows you to take action based on the presence or absence of an
error in Java:</p>
<pre><code class="language-java">import java.io.IOException;
import java.nio.file.Files;
import java.nio.file.Paths;
import java.nio.file.StandardOpenOption;

static void write() {
    try {
        Files.write(
                Paths.get(&quot;file.txt&quot;),
                &quot;content to write&quot;.getBytes(),
                StandardOpenOption.CREATE,
                StandardOpenOption.TRUNCATE_EXISTING
        );
    } catch (IOException e) {
        System.out.println(&quot;Writing to file failed.&quot;);
    }
}
</code></pre>
<p>In Rust, this is roughly equivalent to:</p>
<pre><code class="language-rust">fn write() {
    match std::fs::File::create(&quot;file.txt&quot;)
        .and_then(|mut file| std::io::Write::write_all(&amp;mut file, b&quot;content to write&quot;))
    {
        Ok(_) =&gt; {}
        Err(_) =&gt; println!(&quot;Writing to file failed.&quot;),
    };
}</code></pre>
<p>Frequently, recoverable errors need only be propagated instead of being handled.
For this, the method signature needs to be compatible with the types of the
propagated error. The <a href="https://doc.rust-lang.org/std/result/index.html#the-question-mark-operator-"><code>?</code> operator</a> propagates errors
ergonomically:</p>
<pre><code class="language-rust">fn write() -&gt; Result&lt;(), std::io::Error&gt; {
    let mut file = std::fs::File::create(&quot;file.txt&quot;)?;
    std::io::Write::write_all(&amp;mut file, b&quot;content to write&quot;)?;
    Ok(())
}</code></pre>
<p><strong>Note</strong>: To propagate an error with the question mark operator, the error
implementations need to be <em>compatible</em>, as described in <a href="https://doc.rust-lang.org/book/ch09-02-recoverable-errors-with-result.html#a-shortcut-for-propagating-errors-the--operator"><em>a shortcut for
propagating errors</em></a>. The most general
&quot;compatible&quot; error type is the error <a href="https://doc.rust-lang.org/reference/types/trait-object.html">trait object</a> <code>Box&lt;dyn Error&gt;</code>.</p>
<h2 id="stack-traces"><a class="header" href="#stack-traces">Stack traces</a></h2>
<p>Throwing an unhandled exception in Java will cause the runtime to print a stack
trace that allows debugging the problem with additional context.</p>
<p>For unrecoverable errors in Rust, <a href="https://doc.rust-lang.org/book/ch09-01-unrecoverable-errors-with-panic.html#using-a-panic-backtrace"><code>panic!</code> backtraces</a> offer a
similar behavior.</p>
<p>Recoverable errors in stable Rust do not yet support Backtraces, but it is
currently supported in experimental Rust when using the <a href="https://doc.rust-lang.org/std/error/trait.Error.html#method.provide">provide method</a>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../language/inheritance.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../language/nullability-and-optionality.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../language/inheritance.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../language/nullability-and-optionality.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../ferris.js"></script>


    </body>
</html>
